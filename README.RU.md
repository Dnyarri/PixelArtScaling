
| [〖EN〗](README.md) | 【RU】 |
| --- | --- |

# Программы для масштабирования пиксельных картинок - Pixel Art Scaling

[![PyPI - Downloads](https://img.shields.io/pypi/dm/scalenx)](https://pypi.org/project/ScaleNx/)

Программы для увеличения маленьких малоцветных картинок типа иконок и игровых спрайтов.

Также полезны для улучшения сканов текстов с низким разрешением перед OCR.

> [!NOTE]
> Данная ветка содержит специальную версию, совместимую с Python 3.4. Она может отставать в развитии от [ветки main](https://github.com/Dnyarri/PixelArtScaling/tree/main).

В настоящий момент поддерживаются методы **Scale2x** (aka AdvMAME2x), **Scale3x** (aka AdvMAME3x), **Scale2xSFX** и **Scale3xSFX**.

**ScaleNxGUI.py** представляет собой общую программу с GUI, объединяющую модули графических форматов и масштабирования. Программа обеспечивает как масштабирование отдельных картинок, так и оптовое batch-масштабирование всех картинок в директории и поддиректориях.

> [!NOTE]
> В версии 25.08.22.34 параметры компрессии PNG и выбор формата PPM/PGM можно сохранить на диск в файл `scalenx.ini`, отредактировать в текстовом редакторе, и загрузить обратно в ScaleNx. Подробные сведения высвечиваются при наведении курсора на строку статуса над кнопкой "Exit".

Версия 25.08.22.34 основной программы была злонамеренно переделана с `pathlib` на `os` для обеспечения максимальной совместимости с совсем уж ископаемыми версиями Python. Теперь всякий желающий может посмотреть в исходниках, как папа с мамой делали рекурсивное чтение директорий до появления Path.rglob.

> [!CAUTION]
> **Вынимание:** batch-программа перезаписывает исходные файлы, если хотите сделать копию - делайте это заранее! Batch-программы в этой версии используют асинхронный мультипроцессинг, что резко уменьшает время обработки ценой загрузки всех процессоров на 100%, что делает интерфейс несколько неотзывчивым. Если вам кажется, что программа зависла - не пугайтесь, просто подождите, пока она пропихнёт все потоки со всеми вашими файлами через все процессоры разом.  

## Пример прогона Scale3x дважды по одной картинке

[![Пример прогона Scale3x дважды](https://dnyarri.github.io/imgscalenx/x3x3.png)](https://dnyarri.github.io/scalenx.html)

## Внешние зависимости

1. [PyPNG](https://gitlab.com/drj11/pypng). Копия включена в дистрибутив ScaleNx.
2. [PyPNM](https://pypi.org/project/PyPNM/). Копия включена в дистрибутив ScaleNx.
3. Tkinter, multiprocessing. Входят в состав стандартного дистрибутива CPython.

> [!NOTE]
> Программы написаны целиком на Python, и используют логичное представление картинки как списка списков списков.
> В то время как для человека данное представление является логичным, Python обрабатывает его медленно в сравнении с кодом, скомпилированным из C или C++ (впрочем, желающие могут попытаться указать мне и назвать, а что Python обрабатывает быстро).
> Помимо этого, программы включают переформатирование списков для ввода/вывода PNG и PNM, тоже с использованием исключительно средств Python.
> В результате программы не требуют больших внешних пакетов типа Pillow и numpy, не имеют конфликтов версий, и совместимы со всем, что шевелится, но работают медленно.

## Для разработчиков: как пользоваться модулем ScaleNx

Начиная с версии 2026.2.12.34, рекомендуемый способ применения модуля ScaleNx выглядит так:

```python
from scalenx import scaleNx
scaled_image = scaleNx(source_image, n, sfx)
```

где:

- **`source_image`** - исходная картинка в форме `list[list[list[int]]]`;
- `int` **`n`** может иметь значение `2` или `3`, и означает выбор между алгоритмами Scale2\* и Scale3\*;
- `bool` **`sfx`** означает, хотите ли вы включить методы ScaleNxSFX, или предпочитаете классические ScaleNx.

Однако и старая схема доступа к функциям (от версии 2024.02.24) никуда не делась, и для, например, Scale3xSFX выглядит так:

```python
from scalenx import scalenxsfx
scaled_image = scalenxsfx.scale3x(source_image)
```

## Литература

1. [Первоисточник Scale2x и Scale3x](https://www.scale2x.it/algorithm) - описание алгоритмов автором, Andrea Mazzoleni.

2. [Описание Scale2xSFX и Scale3xSFX](https://web.archive.org/web/20160527015550/https://libretro.com/forums/archive/index.php?t-1655.html) в архивах древнего форума. К сожалению, это единственная обнаруженная ссылка, подлинные имена обсуждающих неизвестны, поэтому надлежащим образом указать авторство невозможно.

3. [Алгоритмы масштабирования пиксельной графики](https://ru.wikipedia.org/wiki/Алгоритмы_масштабирования_пиксельной_графики) - краткий обзор на Wikipedia.

4. [ScaleNx на PyPI](https://pypi.org/project/ScaleNx/) - ядро ScaleNx, установка через *pip*. Чистое ядро без примеров, гуёв и т.п.

## Родственное

1. [Dnyarri website](https://dnyarri.github.io) - остальной товар от Жабы Огромной Умственной Силы.

2. [github Dnyarri](https://github.com/Dnyarri).

3. [gitflic Dnyarri](https://gitflic.ru/user/dnyarri) - зеркало.
